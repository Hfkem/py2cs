## 4.3 馬爾可夫平衡態

在馬爾可夫鏈中，馬爾可夫平衡態是一個非常重要的概念。在這裡，我們介紹馬爾可夫平衡態的定義以及如何檢驗一個馬爾可夫鏈是否具有平衡態。

### 4.3.1 定義

一個馬爾可夫鏈滿足平衡態的條件是：對於任意一個狀態，經過無限次轉換後，該狀態的分佈不再發生變化，進入該狀態的機率等於離開該狀態的機率。換句話說，如果馬爾可夫鏈在某一個時間點的狀態分佈和在另一個時間點的狀態分佈相同，那麼這個馬爾可夫鏈就滿足平衡態。

具體來說，對於一個有限狀態集合 {1, 2, …, n} 的馬爾可夫鏈，若存在一個非負整數向量 π = (π1, π2, …, πn)，滿足以下兩個條件：

- \sum_{i=1}^n \pi_i = 1
- 對於任意 j∈{1,2,…,n}，有 \sum_{i=1}^n \pi_i p_{ij} = \pi_j

其中，p_{ij} 是由狀態 i 轉移到狀態 j 的轉移概率，則稱 π 為該馬可夫鏈的一個平衡態。

可以發現，如果一個馬爾可夫鏈具有平衡態，那麼該鏈的所有平衡態具有相同的分佈。

### 4.3.2 檢驗

考慮一個給定的馬爾可夫鏈，如何檢測該鏈是否具有平衡態？一個可能的方法是，對該鏈進行模擬，觀察隨著時間的推移，該鏈的狀態分佈是否趨向於一個固定的分佈。

具體來說，假設有一個 k 階馬爾可夫鏈，其中 S = {1, 2, …, n} 是狀態集合，轉移機率矩陣為 P。我們在時間 t 初始化一個 n 維列向量 V_t，其第 i 個元素表示在時間 t 狀態為 i 的概率。我們用矩陣乘法來計算狀態分佈在時間 t+1 的分佈：

V_{t+1} = V_t P

透過這種方法不斷重複下去，最終我們可以觀察到狀態分佈是否「穩定下來」，若是，穩定的狀態分佈就是我們所求的平衡態。

通常，為了保險起見，我們還要設置一個容忍度，當狀態分佈的差異小於一個 pre-specified 的值時，我們就認為狀態分佈已經穩定下來。