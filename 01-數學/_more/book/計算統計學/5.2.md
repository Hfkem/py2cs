## 5.2 各種 EM 算法

在 EM 算法中， $Q(\theta, \theta^{(t-1)})$ 函數的形式必須給予。首先介紹三種 EM 算法： Baum-Welch 算法、懶人算法、朴素算法。 

## 1. Baum-Welch 算法

Baum-Welch 算法是常用的 EM 算法之一，用於評估觀測序列，其算法流程如下：

1. 初始化參數：初始化狀態轉移矩陣 $A$、混淆矩陣 $B$，並令 $\Theta_{0} = (A_{0}, B_{0})$， $t=1$。
2. 估計 $Q(\Theta, \Theta^{t-1})$：求解 $P(O|\Theta_{t-1})$，求解出 $\gamma_{t} (i)$ 和 $\xi_{t}(i,j)$，從而計算 $Q(\Theta,\Theta^{t-1})$，如式子（5.49）和式子（5.50）所示。
3. 更新狀態轉移矩陣：更新估計好的狀態轉移矩陣。
4. 更新混淆矩陣：更新估計好的混淆矩陣。
5. 計算收斂標準：如果 $\Theta_{t}$ 與 $\Theta_{t-1}$ 差異小於收斂標準，則算法終止；否則，令 $t=t+1$，返回到第 2 步。

事實上， Baum-Welch 算法就是一種經典的 EM 算法，基本的算法過程就是收斂到一個最佳解。在 Baum-Welch 算法中，概率是使用前向遞推和後向遞推求出的。然後，根據所得到的概率值，運用 EM 算法求出最佳解。

## 2. 懶人算法

懶人算法是不需要使用到 $Q(\theta, \theta^{(t-1)})$ 函數的 EM 算法，代表了一種非常簡便的實現方式。因此，懶人算法被廣泛應用在實務中，其算法流程如下：

1. 初始化參數：初始化模型參數，並令 $t=1$。
2. 估計狀態轉移矩陣：使用前向遞推和後向遞推求解概率，進而估計出狀態轉移矩陣。
3. 估計混淆矩陣：同樣使用前向遞推和後向遞推求解概率，並進而估計出混淆矩陣。
4. 計算收斂標準：如果所有模型參數與其先前估計的相對誤差小於收斂標準，則算法終止；否則，令 $t=t+1$，回到第 2 步。

## 3. 朴素算法

朴素算法是一種適用於連續隨機過程的 EM 算法，其算法流程如下：

1. 初始化參數：初始化狀態轉移矩陣 $A$、混淆矩陣 $B$，並令 $\Theta_{0} = (A_{0}, B_{0})$， $t=1$。
2. E 步：對於收到的每一個觀測值，都計算“系列最小距離”（$L$），即該觀測值到達狀態 $S$，所需的最小時間。使用 $L$ 可以計算出應該在該觀測值與最近狀態敘述之間添加的狀態距離 $\delta$， $\delta$ 可以用於根據最近的狀態 $S$ 更新狀態轉移和混淆矩陣 $A$ 和 $B$。當一個新的狀態被添加，系列距離 $L$ 也隨之變化，因此，這個循環會重複執行直到所有觀測值的系列距離都穩定不變。
3. M 步：這是 Baum-Welch 訓練的一部分，通過計算滿足某些規範的距離矩陣來更新狀態轉移機率和混淆機率。系列距離 $L$ 可以用於更新這些矩陣。
4. 計算收斂標準：如果所有模型參數與其先前估計的相對誤差小於收斂標準，則算法終止；否則，令 $t=t+1$，回到第 2 步。

總結來說， Baum-Welch 算法是實現 EM 算法的標準模板。懶人算法的給予系統更自由，但帶來了一些實現效率上的代價。朴素算法則專門處理連續隨機過程，並且可以實現更大的概率空間，但它更加複雜，難以實現。