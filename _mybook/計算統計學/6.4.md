## 6.4 高維積分計算

高維積分是數學中一個很常見的研究方向，但是高維積分的計算非常的困難，因為直接求解高維積分往往會遇到積分的維數增加，計算量急劇增加，而且受限於存儲計算機記憶體容量和程序運行效率的影響，這些問題都讓高維積分問題變得十分困難。

蒙特卡洛模擬被廣泛用於高維積分的求解。這種方法的主要思想是通過產生各種分佈的隨機數，並利用隨機模擬樣本覆蓋整個積分域進行積分求解，該方法具有不受維數限制、計算簡單高效等特點。

為了方便計算，我們通常把高維積分轉化成機率分布的期望值求解問題。假設 $f$ 為一維積分函數，它在區間 $[a,b]$ 上的積分可以通過均勻分布的隨機樣本點進行近似：

$$ \int_{a}^{b} f(x) dx \approx \frac{(b - a)}{n} \sum_{i=1}^n f(x_i) $$

其中 $x_1, x_2, ..., x_n$ 均勻隨機分布在區間 $[a,b]$ 上。

對於高維積分，可以利用均勻分佈的隨機向量 $\mathbf{x}$ 作為權重 $w(\mathbf{x})$ 的機率分布。將向量 $\mathbf{x}$ 以機率 $\rho(\mathbf{x})$ 的分佈實現隨機模擬，其中 $\rho(\mathbf{x})$ 是讓積分被均勻採樣的機率密度函數。在機率密度函數 $\rho(\mathbf{x})$ 的幫助下，我們可以通過樣本均值和樣本標準差來計算高維積分的期望值：

$$ I = \int_{\mathbf{x} \in \Omega} w(\mathbf{x}) f(\mathbf{x}) d\mathbf{x} \approx \frac{1}{n} \sum\limits_{i=1}^{n} w(\mathbf{x}) f(\mathbf{x_i}) $$

其中， $\mathbf{x}_i$ 是通過隨機模擬方法得到的均勻分布的高維樣本點，且 $n$ 為樣本數量。

範例：考慮一個三維積分問題，求解函數 $f(x_1,x_2,x_3) = e^{-(x_1^2 + x_2^2 + x_3^2)}$ 從 $[0,1]\times[0,1]\times[0,1]$ 的積分。其真實值為 $I = \int_0^1\int_0^1\int_0^1 e^{-(x_1^2 + x_2^2 + x_3^2)} dx_1 dx_2 dx_3 = 0.393$。下面使用 Python 進行蒙特卡洛求解。## 
