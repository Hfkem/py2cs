## 4.4 驗證馬爾可夫性質

在使用馬可夫鏈模型時，檢驗馬可夫性質是否成立非常重要。馬可夫性質是指某一個隨機系統若具有馬可夫性質，則當前狀態的轉移只與前一狀態有關，而與更早的狀態無關。

在馬可夫鏈中，我們需要檢驗以下三個條件是否成立以驗證馬可夫性質：

- 狀態域：馬可夫鏈的狀態必須是可數的，有限或無限都可以。
- 狀態轉移機率：馬可夫鏈的狀態轉移必須滿足轉移機率矩陣中的每一行之和等於 1，且所有轉移機率均大於等於 0。
- 遞歸性：馬可夫鏈至少有一個狀態是遞歸的，即能夠重訪自身。

如果滿足上述三個條件，則可以確認馬可夫性質成立，否則就需要對模型進行調整。

下面我們以一個簡單的例子來驗證馬可夫性質。假設我們有一個骰子，每次擲出的點數為 1、2、3、4、5 或 6，我們可以使用 Python 來模擬這個擲骰子的過程。

首先，我們需要引入 numpy 庫和 random 庫，numpy 庫主要用於數學計算，而 random 庫可以用於生成隨機數。接下來，我們定義一個函數，該函數可以模擬一次擲骰子的過程，返回值為擲出的點數。

```python
import numpy as np
import random

def roll_dice():
    point = random.choice(range(1, 7))
    return point
```

然後，我們可以使用上述函數模擬一個擲骰子序列，假設我們需要模擬 100 次擲骰子。

```python
# 模擬擲骰子序列
dice_sequence = [roll_dice() for _ in range(100)]
```

接下來，我們可以使用 dice_sequence 來建立一個馬可夫鏈模型。假設我們將 1、2、3 視為狀態 1，4、5 視為狀態 2，6 視為狀態 3，然後計算狀態轉移矩陣。

```python
# 將 1、2、3 視為狀態 1，4、5 視為狀態 2，6 視為狀態 3
state_sequence = [1 if i in (1, 2, 3) else 2 if i in (4, 5) else 3 for i in dice_sequence]

# 計算狀態轉移矩陣
n = 3
M = np.zeros((n, n))
for i in range(len(state_sequence) - 1):
    current_state = state_sequence[i] - 1
    next_state = state_sequence[i+1] - 1
    M[current_state][next_state] += 1
M = M / M.sum(axis=1, keepdims=True)
```

最後，我們可以使用已知的三個條件來檢驗馬可夫性質是否成立。

- 狀態域：由於有限狀態數只有 3，因此狀態域成立。
- 狀態轉移機率：狀態轉移機率矩陣中的每一行之和都等於 1，且所有轉移機率均大於等於 0，因此狀態轉移機率成立。
- 遞歸性：由於存在狀態 1、2、3 能夠重訪自身，因此遞歸性成立。

因此，我們可以確認在此例中馬可夫性質成立。